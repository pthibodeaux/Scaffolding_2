# Scaffolding.NLog

## Using this Library

##### Steps

1. Install-Package Scaffolding.NLog from internal nuget store.
2. For default configuration, add the following lines of code to the Startup.Configure method in the Startup.cs file

```
LogManager.Configuration = NLogConfig.CreateConfiguration(env);
loggerFactory.AddNLog();
```

3. For custom configuration, provide the second parameter to the NLogConfig.CreateConfiguration() method
```
LogManager.Configuration = NLogConfig.CreateConfiguration(env, 
new NLogConfiguration
{
	AppName = "Your App Name",
	LogDirectory = "../logs", //Relative path to logs directory wrt to application base path
	LogDirectoryLocal = "logs", //Relative path logs directory for local machine
	EnableAllLogs = true, //default = false
	EnableWebLogs = true //default = true
});
```
4. To use settings from appsettings section, use the NLogConfig.CreateConfiguration() overload method, 
	passing the configuration section as the second parameter
```
	var nlogConfigSection = Configuration.GetSection("Logging:NLog");
	var loggingConfiguration = NLogConfig.CreateConfigurationUsingAppsettings(env, nlogConfigSection);

	Appsettings section should look something like this:
		"Logging": {
			"NLog": {
				"LogLevel": {
					"Default": "Debug",
					"Service*": "Error",
					"*Controller": "Trace",
					"ErrorHandlingMiddleware": "Info"
				}
			}
		}
```


**You are all set!** The logs in localhost can be found in the App's bin directory in the desired configuration folder.

By default, 2 set of log files get generated in "Local" and "Development" hosting environments. 
- **all-logs-{shortdate}.log**
  This file contains all types of logs from the application. System logs, Microsoft logs, application specific logs etc. Max no. of archives = 3.
- **log-{shortdate}.log**
  This file contains only application specific logs that are generated by the ServiceActionFilter and ServiceExceptionFilter from Scaffolding.Web.Utilities package used by apps. Max no. of archives = 10.
  
In environments "Test" and above, only the **log-{shortdate}.log** gets generated.

These settings can however be altered by providing custom configuration in the consuming apps.
